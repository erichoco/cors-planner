define(["require","exports","module"],function(require,exports){function Module(data,status){this.id=data.code.replace(/[_\s\'\"]/gi,"-"),this.data=data,this.status=$.extend({},defaultStatus,status)}function convertClass(klass){var i,j=0,length,key,result=[];for(key in klass)if(klass.hasOwnProperty(key)){length=klass[key].length;for(i=0;i<length;i++)result[j++]=klass[key][i]}return result}var defaultStatus={list:undefined,allocated:{lecture:"",tutorial:"",lab:""}};return Module.Count=function(klass){var key,count=0;for(key in klass)klass.hasOwnProperty(key)&&$.isArray(klass[key])&&(count+=klass[key].length);return count},Module.Format=function(data){var m=$.extend({},data);return $.isEmptyObject(m.lectures)||(m.hasLecture=!0,m.lectures=convertClass(m.lectures)),$.isEmptyObject(m.tutorials)||(m.hasTutorial=!0,m.tutorials=convertClass(m.tutorials)),$.isEmptyObject(m.labs)||(m.hasLab=!0,m.labs=convertClass(m.labs)),m},Module.fn=Module.prototype,Module.fn.get=function(key){return this.data[key]},Module.fn.set=function(key,val){var i,keys=key.split("."),length=keys.length,parent=this.status;for(i=0;i<length-1;i++)parent[keys[i]]=parent[keys[i]]||{},parent=parent[keys[i]];parent[keys[i]]=val},Module.fn.is=function(key,val){var i,keys=key.split("."),length=keys.length,parent=this.status;for(i=0;i<length-1;i++)parent[keys[i]]=parent[keys[i]]||{},parent=parent[keys[i]];return parent[keys[i]]===val},Module.fn.count=function(type){type=type.toLowerCase();if(type==="lectures")return Module.Count(this.data.lectures);if(type==="tutorials")return Module.Count(this.data.tutorials);if(type==="labs")return Module.Count(this.data.labs)},Module.fn.format=function(){return Module.Format(this.data)},Module.fn.isSame=function(other){return typeof other=="object"?this.data.code===other.get("code"):typeof other=="string"?this.data.code===other.toUpperCase():!1},Module.fn.isAllocated=function(type,classNo){return this.status.allocated[type]==classNo},Module.fn.allocate=function(type,classNo){this.status.allocated[type]=classNo},Module.fn.toJSON=function(){return{data:this.data,status:this.status}},Module})