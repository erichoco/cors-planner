define(["require","exports","module","model/modules","util/store"],function(e,t){function s(){r.populate(i.get(planner.list.modules)||[])}function o(){i.set(planner.list.modules,r.toJSON())}var n=e("model/modules"),r=new n(planner.list.modules),i=e("util/store");t.init=function(){setTimeout(function(){s()},500)},$.subscribe("module:save",function(){o()}),$.subscribe("module:add",function(e,t){r.add(t)}),$.subscribe("module:sequence",function(e,t){r.inSequence(t),o()}),$.subscribe("module:preview",function(e,t){var n=r.get(t);n&&$.publish("module:detail",n)}),$.subscribe("module:remove",function(e,t){var n=r.remove(t);n&&$.publish("message:success","Module "+n.get("code")+" is removed")}),$.subscribe("module:clean",function(){r.clean(),$.publish("module:clean:all"),$.publish("message:success","All modules are removed")})});