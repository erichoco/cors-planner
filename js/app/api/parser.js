define(["require","exports","module"],function(e,t){function l(e){return typeof e=="object"&&(e=JSON.stringify(e)),e?e.replace(a,"").replace(f,""):""}function c(e){return e&&e.query&&e.query.results&&e.query.results.table?!0:!1}function h(e){return!/currently not available/i.test(JSON.stringify(e))}function p(e){var t=/Correct as at (\d\d \w{3} \d{4} \d\d:\d\d)\"/.exec(JSON.stringify(e));n.correctAsAt=t?t[1]:undefined}function d(e){var t=1,r;for(r in s)s.hasOwnProperty(r)&&(n[r]=s[r](e[t++].td[1]))}function v(e){return!/No Lecture Class/i.test(JSON.stringify(e))}function m(e){var t,r,i=n.lectures,s,a,f,l=e.length;for(s=1;s<l;s++)if(e[s].td&&e[s].td.length>=o){t={},a=0;for(f in u)u.hasOwnProperty(f)&&(t[f]=u[f](e[s].td[a++]));r=t.weekDay+"-"+t.startTime+"-"+t.endTime,i[r]||(i[r]=[]),i[r].push(t)}}function g(e){return!/No Tutorial Class or to be announced/i.test(JSON.stringify(e))}function y(e){var t,r,i,s=n.tutorials,a=n.labs,f,l,c,h=e.length;for(f=1;f<h;f++)if(e[f].td&&e[f].td.length>=o){t={},l=0,r=u.type(e[f].td[1]);for(c in u)u.hasOwnProperty(c)&&(t[c]=u[c](e[f].td[l++]));i=t.weekDay+"-"+t.startTime+"-"+t.endTime,r==="TUTORIAL"?(s[i]=s[i]||[],s[i].push(t)):(a[i]=a[i]||[],a[i].push(t))}}var n,r=function(e){return e.p?e.p:l(e)},i=function(e){var t=e.content||e.p;return typeof t=="object"?i(t):typeof t=="string"?l(t):"ERROR: PARSE FAILED"},s={code:function(e){return r(e).split(" ")[0]},title:r,description:r,examinable:r,examDate:i,credits:function(e){return parseInt(e.p,10)},prerequisite:r,preclusion:r,workload:r},o=7,u={classNo:r,type:r,weekType:r,weekDay:r,startTime:r,endTime:r,room:i},a=/^\s+/,f=/(,?)\s+$/;t.tryParse=function(e){return c(e)&&h(e.query.results.table[1].tr[1])},t.parse=function(e){if(!c(e))return null;var t=e.query.results.table;return n={},n.url=e.url,h(t[1].tr[1])?(n.isAvailable=!0,p(t[1].tr[0]),d(t[2].tr),n.lectures={},n.tutorials={},n.labs={},v(t[3].tr)&&m(t[4].tr),g(t[5].tr)&&(m(t[5].tr),y(t[6].tr))):n.isAvailable=!1,n}});